
## 前言


MQ 遥测传输 (MQTT) 是轻量级基于代理的发布/订阅的消息传输协议。

该协议的特点有：

使用发布/订阅消息模式，提供一对多的消息发布，解除应用程序耦合。
对负载内容屏蔽的消息传输。
使用 TCP/IP 提供网络连接。
有三种消息发布服务质量：
“至多一次”，消息发布完全依赖底层 TCP/IP 网络。会发生消息丢失或重复。这一级别可用于如下情况，环境传感器数据，丢失一次读记录无所谓，因为不久后还会有第二次发送。
“至少一次”，确保消息到达，但消息重复可能会发生。
“只有一次”，确保消息到达一次。这一级别可用于如下情况，在计费系统中，消息重复或丢失会导致不正确的结果。
小型传输，开销很小（固定长度的头部是 2 字节），协议交换最小化，以降低网络流量。
使用 Last Will 和 Testament 特性通知有关各方客户端异常中断的机制。

再IOT领域，MQTT服务要建设的基础功能：


- 1. 订阅、发布

- 2. 主题管理

- 3. 客户端连接管理

- 4. 订阅管理

- 5. 通讯安全和QoS

- 6. 规则引擎

- 7. 告警

- 8. 监控

- 9. 设备影子

- 10. 设备生命周期

- 11. 固件升级




## 模块概念


### 设备影子

应用程序通过调用云端API UpdateDeviceShadow下发期望状态给设备影子，设备影子再将文件下发给设备端。设备根据影子更新状态，并上报最新状态至影子




